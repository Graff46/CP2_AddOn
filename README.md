# CP2_AddOn
Gameplay AddOn for modification "Cumulative Pack 2" on the game "S.T.A.L.K.E.R.: Shadow of Chernobyl"

Платформа: ТЧ 1.0006 + мод ОП-2 (патч 9, фикс 2)

Список нововведений:

* модифицирован движок (X-Ray Extensions + xrLua Fix от RvP);
* изменен худ - миникарта в виде КПК с индикаторами брони, здоровья и т.д. (из старой версии Солянки);
* изменен инвентарь - добавлены слоты для ножа, бинокля, фонарика и ПНВ, убрано окно описания предмета и расширено окно рюкзака, немного расширен пистолетный слот и пояс увеличен до 16 ячеек;
* описание предмета теперь выводится во всплывающем окне при наведении курсора на предмет, в описании указываются параметры костюмов, оружия, артефактов, содержимое контейнеров с артефактами;
* таким же образом описание выводится и в других окнах (торговли и обыска);
* добавлены ячейки быстрого использования предметов как в ЗП (только в инвентаре, на худ не стал выводить) - чтобы поместить предмет в ячейку, нужно перетащить его туда из рюкзака (вкл/откл в опциях);
* замок теперь действительно кодовый: чтобы установить его на тайник, нужно ввести код, который и станет ключом к тайнику. Потом, при каждом обыске, придется вводить код - главное не забудьте его, иначе тайник не открыть. Это, так сказать, плата за то, что тайник под защитой;
* в ПДА добавлены новые функции: записная книжка, таймер-будильник и отправка сообщений. В сообщении можно спросить о следующем выбросе - вам сообщат примерное время;
* в ПДА добавлена статистика найденных артефактов, за них тоже начисляется ранг;
* возможность заменить передачи "Сказочника" по радио на радио "Чернобыльский Апрель" - вкл/откл в опциях. Для работы нужно скачать архив с музыкой: https://yadi.sk/d/BaoHDYvU322Gsq
* добавлено "умное" выпадение трофеев с монстров;
* при отрезании трофеев ГГ на некоторое время обездвижен (т.к. занят);
* всвязи с тем, что частей монстров стало намного больше, снижена их цена и увеличено количество при обмене и в некоторых квестах;
* убрано ограничение на обмен патронов у торговцев, Ворону в обмен добавлена шрапнель;
* изменена радиация на Болотах - теперь по воде можно будет ходить, имея нормальные артефакты от радиации;
* у артефактов задействован параметр сытости, теперь если арт на поясе имеет в свойствах увеличение голода - запасайтесь продуктами;
* булыжник теперь не совсем бесполезен - он немного добавляет переносимый вес (компенсация за неудачную артмодификацию);
* маскировочная экза лишь немного изнашивается при использовании (не убивается в хлам);
* ремкомплектом теперь можно починить и холодное оружие;
* изменена починка холодного оружия у Василия - чинит чисто за деньги;
* уменьшена пуленепробиваемость некоторых нпс (танки, спецназ);
* озвучка лута нпс из ЗП ("Так, мужик, чего ж там у тебя...");
* за телепортацию теперь не снимаются деньги (это же полный бред) - для перемещения достаточно повесить на пояс любой артефакт. Если артов на поясе много, то используется самый дешевый из них;
* исправлен бессмертный вертолет на ЧАЭС - теперь его можно сбить (достал он меня);
* копирование quicksave-сохранений в резерв (вкл/откл в опциях);
* возможность задать любое имя пользователя (в опциях) - которое выводится в некоторых сюжетных смс при обращении к игроку;
* расширены игровые опции, опции АМК перенесены в общее меню, изменена система сохранения опций;
* перенесена директория хранения служебных файлов (подсчет сметрей, статистика ОП-2) из папки savedgames в отдельную папку - statistic;
* сделана небольшая оптимизация: сэйвы грузятся немного быстрее;
* скриптовая консоль (вкл/откл в опциях) - с ее помощью можно заспавнить предмет, выдать инфопоршень при проблемах с прохождением. Полная справка по консоли - команда help.

Для читеров :D
* добавлено спавн-меню со всеми предметами;
* меню телепортации по локации;
* меню поиска предметов и тайников;
* подсветка рестрикторов (только скриптовых) и установка меток на аномалии;
* видимые и слышимые телепорты;
* возможность перемирия с группировками, которые должны быть друзьями/нейтралами, минуя Сидоровича.
Все это добро (кроме телепортов - их всегда видно и слышно) включается в опциях.


Дополнено:
11.03.16:
* при открытии инвентаря, КПК или обыске трупа оружие убирается;
* чтобы починить предмет, перетащите на него соответствующий ремкомплект (работает только с предметами в слотах);
* исправлены ошибки;

13.03.16:
* монолитовцы и прочие враги теперь в неладах с мутантами (а то раньше можно было наблюдать картину, как снайпер сидит себе, караулит Меченого, а вокруг него мирно собачки бегают);
* из описания оружия (того, что в xml) убрано описание ттх, аддонов и боеприпасов, т.к. сейчас это выводится в окно скриптом;
* исправлены ошибки;

17.03.16:
* при получении какой-либо информации (добавлении новой статьи в КПК) приходит сообщение о том, в каком разделе можно ее прочитать;
* при выбросе ПДА не работает (как интерфейс, так и на худе), так же изменена сюжетная поломка КПК на Кордоне (за идею спасибо Dennis_Chikin);
* вес контейнера с артами в описании показывается с учетом находящихся в нем артефактов;
* исправлены ошибки;

10.04.16:
* снижены характеристики у некоторых слишком сильных артефактов ("Мох", "Репей"...);
* включена и исправлена схема гранатометания для нпс, добавлены новые гранаты: M61 и ГД-05 (дымовая);
* немного переделана схема выпадения лута с трупов: теперь в трофейном стволе может остаться немного патронов;
* в перепвковщик добавлены все патроны;
* для костюма "СКАТ-15" сделана "панель управления": вызывается при клике по костюму в слоте - можно включить/отключить функции;
* добавлен новый бинокль: с дальномером и тепловизором, появляется в продаже у Сяка. Обычный бинокль теперь - это обычный бинокль (пардон за тавтологию);
* выброс вырождает все артефакты (кроме квестовых), но с меньшей вероятностью (у меня максимум было 5 штук за выброс, не такая уж большая потеря);
* но зато теперь в контейнер можно положить любой артефакт, так что прячьте самые нужные арты в контейнеры: там выброс их не достанет;
* убраны фризы при приближении ГГ к нычке, в которой много предметов;
* убраны подвисания: если в КПК много заданий типа "принести предмет" (или несколько), и при этом в инвентаре много предметов - подвисало каждую секуду, т.к. перебирался полностью, и не по одному разу, весь инвентарь актера (за наводку спасибо dsh). Это не касается "хомячных" квестов на "принести исправное оружие/броню" - там всё оставил как было, т.к. не беру эти задания, пока не соберу всё необходимое (и вам советую делать так же);
* исправлены ошибки;

21.05.16
* изменена радиация: движковая радиация заменена на New Radiation mod от ARC (такое было в моде "Тайные Тропы 2"). Т.е. теперь доза радиации накапливается постепенно и так же постепенно выводится, и не получится одним антирадом избавиться от всей накопленной дозы радиации за раз. То же самое и с артефактами: сколько бы артов от радиации вы ни повесили на пояс, быстро накопленная доза все равно не уйдет. При этом облучиться можно за считанные секунды, особенно при отсутствии хорошей защиты. Так что теперь надо быть аккуратней в зонах с повышенным фоном. Радиацию выводят антирады, научные аптечки и, немного, водка;
* всвязи с новой системой радиации, ее шкала на худе заменена на шкалу пси-здоровья, также немного изменен сам худ;
* немного переделано окно описания предмета: оно теперь меняет размеры в зависимости от размера текста описания, убрана иконка, и над шкалой износа отображается состояние предмета в процентах;
* напоминания о заданиях теперь выводятся не через смс, а сообщением на экране, ниже надписи о текущем активном задании при удержании кнопки Tab (или какая у вас назначена на "Напоминания");
* в описании контейнера с артефактами отображается излучаемая им радиация (если в нем лежат слишком радиоактивные артефакты);
* названия предметов, которые находятся в слотах, подсвечиваются зелёным;
* переделан износ холодного оружия: задействован параметр condition_shot_dec из конфига, по которому износ и считается. При ударе по ящику/стене/земле оружие тоже изнашивается;
* добавлено кэширование в sound_theme.script, благодаря чему немного улучшена производительность (в игре на моем ПК почти не заметно, но, может, будет заметнее на слабых машинах - спасибо [member=Zander_Driver]);
* переделана торговля с нпс: всё проданное неписям при закрытии окна удаляется из игры, также ассортимент торговцев теперь не обновляется при каждом save/load;
* исправлен баг при первом использовании контейнера для артов (балласт иногда не перезаряжался);
* добавлен EnvFX: нoвaя библиoтeкa OpenAL, кoтoрaя включaeт пoддeржку EAX 2.0 (Environmental Audio eXtension) нa всeх aудиo-кaртaх в игрe STALKER, a тaкжe дoбaвляeт цeлый нaбoр дoпoлнитeльных нaстрoeк, знaчитeльнo улучшaющих вoсприятиe aтмoсфeры игры. Настройки дополнения можно найти в игровых опциях, на вкладке "Звук"
Сaйт прoeктa: http://imasters.org.ru
* добавлена правка фотоаппарата: при включенном спавнере можно фотографировать монстров и аномалии, не наводя на них фотоаппарат (так называемое "фото со спутника") - главное, чтобы монстр находился в радиусе онлайна (150 метров), а аномалия была не дальше 10-ти метров от ГГ;
* убрано ограничение по иммунитетам артов на поясе, т.к. ничего хорошего, кроме лишних тормозов, это в игру не добавляло;
* переделаны некоторые скрипты, обрабатывающие сюжет (как из оригинала, так и соляночные) - всё оттестить я не успел (не хочется опять начинать новую игру), так что возможны баги. При обнаружении - обязательно писать в л.с.;
* пофиксены некоторые баги солянки;

3.06.16
* обновлена ревизия X-Ray Extensions до r232. Исключена правка, вызывавшая глюки погоды (прерывался погодный эффект во время выброса);
* исправлена смерть сталкеров при переходе в онлайн в местах большого скопления нпс (by bardak);
* переделан фикс повторного выпадения тайников с неписей: теперь с непися можно снять тайник/деньги, даже если сделать save/load после его смерти - данные хранятся в серверном классе нпс;
* исправлен квест на тайник Сыча в Х-10: тайник появляется только после получения задания при взятии флешки с трупа Сыча;
* переделан идиотский диалог с Ворониным про документы;
* изменена система снятия трофеев с монстров: теперь ГГ не обездвиживается, только прячет оружие, но если он сойдёт с места во время отрезания "запчасти", все трофеи вернутся обратно к монстру в инвентарь. Т.о., процесс можно в любой момент прервать, но потом придётся начинать всё с начала;
* перемещён переход "Тёмная Долина - Армейские Склады" (постоянно хожу на базу бандитов через трубу, и постоянно в него попадаю - надоело);
* поставлена метка на переход "Дикая Территория - Бар";
* исправлены все найденные баги и вылеты (глюк с дверью на Затоне, вылеты по новым скриптам) - спасибо товарищам DarkThrone75, Hunter_090, Snatex, hlebin;
* много мелких исправлений и доделок;

03.07.16
* переделан замок для тайников - теперь его можно поставить только на тайники, которые можно закрыть на замок (ящики, сейфы), на разные рюкзаки, пни, трубы замок повесить нельзя (можно отключить в файле zamok.script - отмечено комментарием);
* добавлена озвучка нпс в схеме медика (xrs_medic.script) - изменение малозаметное, т.к. из-за ужасного оружейного баланса раненых неписей встретить можно крайне редко, в основном помирают сразу));
* спавн артефактов теперь можно настроить в файле config\misc\amk_arts_spawn.ltx. Структура:
	- для уроня секция имеет название [<имя_уровня>_arts],
	- параметр spawn_count - это максимальное количество артов, которое может быть заспавнено за раз (рандом, от 1 до spawn_count),
	- секция_арта = вероятность спавна. Чем больше цифра по отношению к другим в этой же секции, тем больше вероятность заспавнить этот артефакт.
* бумажные деньги (которые можно найти в трупах) больше сами по себе не превращаются в электронные - обменять их можно будет только у Бармена (но хотя бы одну пачку перед этим надо использовать);
* убрано отключение КПК во время выброса ("по заявкам пользователей", да и с новым худом лень было совмещать);
* изменён "поцелуй" кровососа - ГГ обезвиживается на некоторое время;
* добавлена адаптация худа "Oracle Hud Serafim12 ver.1.3" - ставить по желанию (папка Oracle_hud);
* исправлены найденные баги и вылеты, различные доделки и исправления.

19.07.16
* в основном исправления найденных ошибок;
* переделано окно диалога (не скрывался лист чата при диалоге с "О-Сознанием");
* немного переделан сон: если ГГ не спал сутки или более, то за раз полностью выспаться не получится, хотя в глазах и перестанет двоиться. Аптечки добавляют немного сонливости, энерегетики отнимают - как и было в оригинале АМК;
* починил сообщения о выбросе в АМК-овских новостях. Теперь, если пишут о выбросе в такое-то время, стоит прислушаться. Также - в новостях - восстановил "пропадание сигнала" в подземных локациях: новостные сообщения при отсутствии сигнала не приходят совсем (не влияет на сюжетные СМС);
* вырождение артефактов - вырождаются только артефакты, полученные (или которые можно получить) не естественным путём - то есть, все модификаты и сваренные в аномалиях артефакты. Все арты, которые в принципе не могут рождаться во время выбросов (модификаты) убраны из доспавна.

14.09.16
* исправлены найденные баги и вылеты:
    - пропадание уникальных предметов и переодевание уникальных нпс в другую броню;
    - квест Захара на ножи (теперь принимает любые - и фейки, и настоящие);
    - враждебность монолита в Лабиринте в финале сюжета по алмазным черепам;
    - вылет при использовании детектора изоморфов;
    - вылет при попытке нпс поднять имитатор аномалии;
* изменено окно описания в инвентаре: параметры предметов выводятся с иконками (как в ЗП);
+ так же выводятся в описании параметры еды/медикаментов;
+ адаптирован "AI Additions" от Bak, версия для ОП-2 ( http://www.amk-team.ru/forum/topic/4653-ai-additions );
+ для всех торговцев отключен менеджер оружия (они постоянно напяливали навесы на продаваемые стволы);
* исправлены АМК'овские парсеры нет-пакетов;
- удалены библиотеки Env Fix  из bin, а так же его настройки в опциях игры;
* по умолчанию оставлен минималистичный Oracle HUD, соляночный худ удален;
* исправлено обновление ассортимента у торговцев, время обновления хранится в серверном классе;
* переделан фикс "тормозов" при подходе к нычкам;
* испавлено (теперь вроде полностью) нежелание ГГ спать из-за того, что ему "страшно". Страшно теперь только во время ЧУ (где-то с 21:55 до 22:10); 
+ в динамические аномалии добавлены радиоактивные зоны;
+ сталкеры в сети реагируют на отправленные в смс приветствия (не доделано);
+ равнозначные слоты (1 и 2) для основного оружия (как в ЗП). В любой из двух слотов ставится только оружие, капсулы с аномалиями и эмбрионы - по-прежнему только в первый слот;
+ иконки предметов, находящихся в слотах, подсвечиваются зелёным в окнах обыска и торговли;
* при сдаче Бармену налички (пачек денег, найденных в трупах), он считает ее всю и обменивает тоже всю за раз;
- удалён мод "Спутниковые карты".

29.09.16
* Исправление ошибок и мелкие правки;
* Восстановлено выпадение в трупах некоторых экзоскелетов (случайно удалил);
* Немного переделаны квесты по Костиным тайникам (изменения не касались геймплея - надо тестить);
+ Энергозависимые ПНВ и фонарик - заряд аккумулятора в устройстве постепенно кончается, после чего оно перестаёт работать. Фонарик при этом выключается не сразу, а постепенно - светит всё хуже и хуже. Уровень заряда аккумулятора в устройстве можно узнать по износу предмета. Чтобы сменить аккумулятор, надо перетащить его на девайс в слоте: батарейка сменится, если заряд менее 80%. Возможны нестыковки с сюжетными поломками фонарика и ПНВ - но это буду править, как сам до туда доиграю)

02.10.16
* исправление ошибок;
+ грузоподъёмность экзоскелетов меняется с износом;
+ Акиму в продажу добавлены батарейки;
+ после посещения ЧАЭС переход "Припять - ЧАЭС" задаёт вопрос о смене уровня.

6.11.16
* исправление ошибок, небольшие переделки

24.12.16
* исправление ошибок и оптимизация;
* исправлен xr_box, поэтому, возможно, из ящиков будет выпадать больше лута;
* немного урезан сон - ГГ может спать столько, насколько он устал.

25.12.16
+ с фотоаппаратом можно бегать;
+ восстановлены "ночные" артефакты: некоторые арты появляются только ночью, с 0 до 5 часов. Это: "Ночная звезда", "Золотая рыбка", "Душа", "Золотой ломоть", "Бенгальский огонь", "Вспышка" и "Лунный свет".

06.01.17
* переделаны таймеры, ситстема регистрации каллбэков и сохранение данных в "псторе" и в task_manager (для экономии места);
+ ночным артам повышена цена;
+ при сюжетной поломке фонарика, он не исчезает из инвентаря, а просто не включается, как и ПНВ.

16.01.17
* исправления в некоторых аи-схемах;
* переделаны таймеры варки артефактов. Таймеры теперь не удаляются при сохранении, но злоупотреблять, запуская over 100500 варок, всё же не советую.
* много других мелких изменений и исправлений.

26.01.17
+ при резком падении здоровья или при уровне выносливости ниже половины, ГГ немного быстрее начинает хотеть спать;
* исправлен и немного доработан OGG-плеер;
* исправлена ошибка в формуле подсчёта усталости после сна, из-за которой ГГ совсем мало спал;
+ в меню спальника отображается шкала усталости ГГ и общее максимальное время, которое он может поспать;
* всплывающее окно с описанием предмета не отображается при открытии других интерфейсов внутри инвентаря (плеер, трансмутатор и .д.);

29.01.17
* исправлена логика рестрикторов на Неразведанной Земле, из-за которых раньше времени мог быть удалён вертолёт с Пантерой и Звездочётом;
* исправлен БТР Клыка (в котором он "погибает") на второй ЧАЭС (из-за каких-то проблем с настройками модели не хотел ехать - может, виноват движок XE, а может, и в чистом ОП-2 так же было - не знаю);
* исправлены светошумовые гранаты - эффект запускается только при взрыве гранат, которые кидают нпс. Гранаты, брошенные актером, на него не влияют;
* переделан OGG-плеер - как интерфейс, так и скриптовая часть. Выкинуто много ненужного из xml. Теперь существует 5 режимов воспроизведения:
	- играть один трек (повтор отключен);
	- повторять один трек;
	- повторять все треки с одной флешки по кругу;
	- воспроизведение в случайном порядке с одной флешки;
	- воспроизведение в случайном порядке со всех имеющихся флешек;
Также добавлены кнопки переключения треков и таймер со шкалой длительности трека.
Для добавления своей музыки надо:
	- закинуть обработанные в СДК треки так же, как и раньше, по папкам в sounds\ogg_player\;
	- вписать названия треков соответственно номерам в описание флешек в config\text\rus\string_table_ogg_flash_*.xml (тоже, как раньше);
	- при необходимости добавить которкие названия флешек в файл config\text\rus\string_table_ogg_flash_short.xml - они будут отображаться в меню плеера.
	- в config\ui\ui_cheat_flash_*.xml ничего больше вписывать не надо, эти файлы не используются.

Готовые флешки можно скачать здесь: https://yadi.sk/d/eVWWzlvL3BeufN
Список треков: https://yadi.sk/i/UthwR-W_3DY6my

После установки дополнения новая игра не нужна. Если до этого играли в чистую ОП-2.09.2, то просто перенесите свои сохранения по пути %Папка с игрой%\userdata\savedgames\ и продолжайте дальше. Если играете с худом из  папки "NS hud", то его при установке обновления тоже нужно обновить.

По всем вопросам писать:
	почта 1: naxac@spaces.ru
	почта 2: naxac86@gmail.com
	или в л.с. на форуме AMK: http://www.amk-team.ru/forum/
